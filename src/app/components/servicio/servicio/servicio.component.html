<!-- Edit/Delete Buttons -->
<div
  class="position-fixed bef bef-top-15per top-md-10per end-0"
  *ngIf="
    identity &&
    identity.role == 'ROLE_ADMIN' &&
    canChange === true &&
    isAdmin === true
  "
>
  <button
    *ngIf="editSwitch == false"
    class="btn bef bef-btn-linkM bef-text-bg1M mr-2"
    (click)="switchEdit()"
  >
    <svg
      width="1em"
      height="1em"
      viewBox="0 0 16 16"
      class="bi bi-pencil-square"
      fill="currentColor"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456l-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"
      />
      <path
        fill-rule="evenodd"
        d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"
      />
    </svg>
  </button>

  <button
    *ngIf="editSwitch == true"
    class="btn bef bef-btn-linkM bef-text-bg1M mr-2 font-weight-normal float-right"
    (click)="switchEdit()"
  >
    X
  </button>

  <button class="btn btn-warning mr-2" (click)="deleteServicio(servicio._id)">
    <svg
      width="1em"
      height="1em"
      viewBox="0 0 16 16"
      class="bi bi-trash-fill"
      fill="currentColor"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5a.5.5 0 0 0-1 0v7a.5.5 0 0 0 1 0v-7z"
      />
    </svg>
  </button>
</div>

<h2 *ngIf="servicio && servicio.title" class="my-3 mx-auto text-center">
  {{ servicio.title }}
</h2>

<img
  *ngIf="servicio && servicio.mainImg && servicio.mainImg.location"
  class="bef bef-wmx-65per bef-hmx-500px mx-auto d-block obj-fit-cover"
  src="{{ urlServicio + 'get-file/' + servicio.mainImg.location }}"
  alt="{{ servicio.mainImg.title }}"
/>

<!-- Description -->
<div
  *ngIf="servicio.desc && servicio.desc !== ''"
  class="bef bef-w-65per mx-auto my-5 text-center"
  [innerHTML]="
    Linkify(this.valuefy(servicio.desc), '#000', '#4b8ff5') | safeHtml
  "
></div>

<!-- Edit Main Section -->
<section *ngIf="servicio && editSwitch === true">
  <h3 class="bef bef-text-titleM text-center">Datos de la solución</h3>

  <!-- Title Edit -->
  <div class="d-block w-75 mx-auto my-3">
    <label class="bef bef-text-textM mb-1 d-block" for="title">Título</label>
    <input
      class="w-100 bef bef-text-bg1M bef-btn-textM border-0"
      type="text"
      name="title"
      #title="ngModel"
      [(ngModel)]="servicio.title"
      placeholder="Título"
      required
    />
    <span
      class="bef bef-text-titleM font-weight-bold"
      *ngIf="!title.valid && title.touched"
    >
      El título es obligatorio.
    </span>
  </div>

  <!-- Description Edit -->
  <div class="d-block w-75 mx-auto my-3">
    <label class="bef bef-text-textM mb-1 d-block" for="desc"
      >Descripción</label
    >
    <textarea
      class="w-100 bef bef-text-bg1M bef-bg-textM border-0"
      type="text"
      name="desc"
      #desc="ngModel"
      [(ngModel)]="servicio.desc"
      placeholder="Descripción"
      required
    ></textarea>
    <span
      class="bef bef-text-titleM font-weight-bold"
      *ngIf="!desc.valid && desc.touched"
    >
      La descripción es obligatoria.
    </span>
  </div>

  <!-- Tags Edit -->
  <div class="d-block w-75 mx-auto my-3">
    <label class="bef bef-text-textM mb-1 d-block" for="tags"
      >Palabras clave</label
    >
    <input
      class="w-100 bef bef-text-bg1M bef-bg-textM border-0"
      type="text"
      name="tags"
      #tags="ngModel"
      [(ngModel)]="servicio.tags"
      placeholder="Palabras clave"
    />
  </div>

  <!-- UrlTitle Edit -->
  <div class="d-block w-75 mx-auto my-3">
    <label class="bef bef-text-textM mb-1 d-block" for="urltitle"
      >link-de-la-solucion-sin-acentos-ni-espacios)</label
    >
    <input
      class="w-100 bef bef-text-bg1M bef-bg-textM border-0"
      type="text"
      name="urltitle"
      #urltitle="ngModel"
      [(ngModel)]="servicio.urltitle"
      placeholder="link-de-la-solucion-sin-acentos-ni-espacios"
    />
  </div>

  <!-- Submit Button -->
  <button
    (click)="onSubmit()"
    class="btn bef bef-btn-linkM bef-text-bg1M mx-auto d-block my-3 w-75"
  >
    <ng-container *ngIf="servicio._id === ''; else elseTemplate">
      Crear
    </ng-container>
    <ng-template #elseTemplate> Editar </ng-template>
    solución
  </button>

  <div *ngIf="servicio.desc !== '' && servicio.title !== ''">
    <hr class="w-100 d-block mx-auto my-5" />

    <!-- Photo Equip Member Upload -->
    <h3 class="bef bef-text-titleM text-center">
      Subida de la imagen de la solución
    </h3>
    <img
      *ngIf="servicio && servicio.mainImg && servicio.mainImg.location"
      class="bef bef-wmx-75per d-block mx-auto bef-hmx-25vh my-3"
      src="{{ urlServicio + 'get-file/' + servicio.mainImg.location }}"
      alt="{{ servicio.mainImg.title }}"
    />
    <app-file-uploader
      [type]="'servicio'"
      [typeMeta]="'one'"
      [typeThingComRes]="'servicio'"
      [thing]="servicio.mainImg"
      [thingInside]="true"
      [id]="servicio.urltitle"
      (pre_loader)="pre_load($event)"
      (recoverThing)="recoverThingFather($event)"
    ></app-file-uploader>
  </div>
</section>
